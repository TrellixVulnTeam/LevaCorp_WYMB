{% extends 'base.html' %}
{% load navBarTags %}
{% block content %}
{% load exampleTags %}

<div
	id="wrapper"
	class="active"
>
	<!-- Navbar -->
	{% listarDispositivos %}
	{% include 'navBar.html' with dispositivos=dispositivos %}

	<!-- Fin Navbar -->
	<!-- Page content -->

	<div id="page-content-wrapper">
		<!-- Keep all page content within the page-content inset div! -->

		<div class="page-content inset">
			<div class="fondo"></div>

			<div class="wizard-container">
				<div class="container cont-principal">
					<div
						class="card wizard-card"
						id="wizard"
					>
						{% if disp.getId is not None %}

						<div class="stepwizard">
							<div class="stepwizard-row setup-panel">
								<div class="stepwizard-step">
									<a
										href="#step-1"
										type="button"
										class="btn btn-danger btn-circle"
									>General</a>
								</div>

								<div class="stepwizard-step">
									<a
										href="#step-2"
										type="button " onclick="cambiarIdsTags()"
										class="btn btn-danger "
										disabled="disabled"
									>Tags</a>
								</div>

								<div class="stepwizard-step">
									<a
										href="#step-3" onclick="cambiarIdsDataSreams()"
										type="button"
										class="btn  btn-danger"
										disabled="disabled"
									>Datastreams</a>
								</div>
							</div>
						</div>

						<form method="POST">
							{% csrf_token %}

							<div class="row setup-content justify-content-center p-4" id="step-1">
								<div class="col-xs-12">
									<div class="col-md-12">
										<h3 class="text-center">INFORMACION GENERAL</h3>

										<!-- content go here -->

										<div class="div-principal">
											<div class="row">
												<div class="col-md-4 mb-3">
													<label for="validationDefault01"><strong>ID</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="idDispositivo"
														id="validationDefault01"
														placeholder="ID"
														value="{{ disp.getId }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<label for="validationDefault02"><strong>Titulo</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="titulo"
														id="validationDefault02"
														placeholder="Titulo"
														value="{{ disp.getTitle }}"
														required="required"
													></input>
												</div>

                                                <div class="col-md-4 mb-3">
													<label for="validationDefault02"><strong>IP</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="ip"
														id="validationDefault02"
														placeholder="IP"
														value="{% if ipDisp %}{{ ipDisp }}{% endif %}"
													></input>
												</div>

											</div>

											<div class="row">
												<div class="col-md-4">
													<label for="validationDefault03"><strong>localizacion</strong></label>
												</div>
											</div>

											<div class="row">
												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="localizacionLatitud"
														id="validationDefault04"
														placeholder="Latitud"
														value="{{ disp.getLocation.lat }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="localizacionLongitud"
														id="validationDefault05"
														placeholder="Longitud"
														value="{{ disp.getLocation.lon }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="localizacionElevacion"
														id="validationDefault06"
														placeholder="Elevacion"
														value="{{ disp.getLocation.ele }}"
														required="required"
													></input>
												</div>
											</div>

											<div class="form-group">
												<label for="DescripcionDisp"><strong>Descripcion</strong></label>

												<textarea
													class="form-control"
													id="exampleFormControlTextarea1"
													name="descripcion"
													rows="3"
												>{{ disp.getDescription }}</textarea>
											</div>
										</div>

										<div class="container boton-footer">
											<div class="row justify-content-end">
												<button
													class="btn btn-danger nextBtn"
													type="button"
												>Siguiente</button>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div
								class="row setup-content justify-content-center p-4"
								id="step-2"
							>
								<div class="col-xs-12">
									<div class="col-md-12">
										<h3 class="text-center">Tags</h3>

										<!-- content go here -->

										<div
											id="tags"
											class="div-principal"
										>
											<div class="form-row">
												<div class="col col-6 col-md-3">
													<div class="row col-md-4 mb-3">
														<label for="validationDefault01"><strong>Entidad</strong></label>
													</div>
												</div>

												<div class="col col-12 col-md-8">
													<div class="row">
														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagEntidadEsp"
																id="validationDefault05"
																placeholder="Español"
																value="{{ disp.getTags.0 }}"
																required="required"
															></input>
														</div>

														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagEntidadIng"
																id="validationDefault05"
																placeholder="English"
																value="{{ disp.getTags.1 }}"
																required="required"
															></input>
														</div>
													</div>
												</div>
											</div>

											<div class="form-row">
												<div class="col col-6 col-md-3">
													<div class="row col-md-4 mb-3">
														<label for="validationDefault01"><strong>Funcionalidad</strong></label>
													</div>
												</div>

												<div class="col col-12 col-md-8">
													<div class="row">
														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagFuncionalidadEsp"
																id="validationDefault05"
																placeholder="Español"
																value="{{ disp.getTags.2 }}"
																required="required"
															></input>
														</div>

														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagFuncionalidadIng"
																id="validationDefault05"
																placeholder="English"
																value="{{ disp.getTags.3 }}"
																required="required"
															></input>
														</div>
													</div>
												</div>
											</div>

											<div class="form-row">
												<div class="col col-6 col-md-3">
													<div class="row col-md-4 mb-3">
														<label for="validationDefault01"><strong>Nombre</strong></label>
													</div>
												</div>

												<div class="col col-12 col-md-8">
													<div class="row">
														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagNombreEsp"
																id="validationDefault05"
																placeholder="Español"
																value="{{ disp.getTags.4 }}"
																required="required"
															></input>
														</div>

														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																name="tagNombreIng"
																id="validationDefault05"
																placeholder="English"
																value="{{ disp.getTags.5 }}"
																required="required"
															></input>
														</div>
													</div>
												</div>
											</div>

											{% with contador=0 %}
											{% if disp.getPersonalizedTags %}
											{% for tags in disp.getPersonalizedTags %}
											<div
												class="form-row"
												id="formTag"
											>
												<div class="col col-6 col-md-3">
													<div class="row col-md-4 mb-3">
														<button
															id="eliminarTag"
															type="button"
															onclick="eliminarTag(this)"
															class="rounded-circle btn btn-outline-danger"
														>-</button>
													</div>
												</div>

												<div class="col col-12 col-md-8">
													<div class="row">
														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																id="inputTagEspañol"
																placeholder="Español"
																value="{{ tags.0 }}"
															></input>
														</div>

														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																id="inputTagIngles"
																placeholder="English"
																value="{{ tags.1 }}"
															></input>
														</div>
													</div>
												</div>
											</div>

											{{ contador.as_hidden|add:1 }}
											{% endfor %}
											{% endif %}

											<input
												id="contadorTags"
												type="hidden"
												value="{{ contador }}"
											></input>

											{% endwith %}

											<div class="form-row">
												<div class="col col-6 col-md-3">
													<div class="row col-md-4 mb-3">
														<button id="agregarTag"	type="button" onclick="agregartag()" class="rounded-circle btn btn-outline-success">+</button>
													</div>
												</div>

												<div class="col col-12 col-md-8">
													<div class="row">
														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																id="tagEspañol"
																placeholder="Español"
															></input>
														</div>

														<div class="col-md-6 mb-3">
															<input
																type="text"
																class="form-control inputs"
																id="tagIngles"
																placeholder="English"
															></input>
														</div>
													</div>
												</div>
											</div>
										</div>

										<div class="container boton-footer">
											<div class="row justify-content-end">
												<button
													class="btn btn-danger nextBtn"
													type="button"
												>Siguiente</button>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="row setup-content justify-content-center p-4" id="step-3">
								<div class="col-xs-12">
									<div class="col-md-12">
										<h3 class="text-center">Datastreams</h3></br>
										<div id=dataStreams>
										<!-- content go here -->
										{% if disp.getPersonalizedDataStreams %}
                                        {% for datastreams in disp.getPersonalizedDataStreams %}
										
										<div class="div-principal" id="dataStream00">
											<h2 id="dataStreamH200">{{ datastreams.datastream_id }}</h2>
											<div class="form-row">
												<div class="col mb-3">
													<label ><strong>Nombre</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="inputNombre00"
														id="inputNombre00"
														placeholder="Nombre"
														value="{{ datastreams.datastream_id }}"
														required="required"
														onchange="changeNameDataStream(this);"
													></input>
												</div>
											
											</div>

											<div class="form-row">
												<div class="col-md-4 mb-3">
													<label ><strong>Valor maximo</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="inputValorMaximo00"
														id="inputValorMaximo00"
														placeholder="Valor Maximo"
														value="{{ datastreams.max_value }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<label ><strong>Valor minimo</strong></label>

													<input
														type="text"
														class="form-control inputs"
														name="inputValorMinimo00"
														id="inputValorMinimo00"
														placeholder="Valor Minimo"
														value="{{ datastreams.min_value }}"
														required="required"
													></input>
												</div>
											</div>

											<div class="form-row">
												<div class="col col-6 col-md-3">
													<label ><strong>Unidad</strong></label>
												</div>
											</div>

											<div class="form-row">
												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="inputSimbolo00"
														id="inputSimbolo00"
														placeholder="Símbolo"
														value="{{ datastreams.unit.symbol }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="inputEtiqueta00"
														id="inputEtiqueta00"
														placeholder="Etiqueta"
														value="{{ datastreams.unit.label }}"
														required="required"
													></input>
												</div>

												<div class="col-md-4 mb-3">
													<input
														type="text"
														class="form-control inputs"
														name="inputTipo00"
														id="inputTipo00"
														placeholder="Tipo"
														value="{{ datastreams.datastream_type }}"
														required="required"
													></input>
												</div>
											</div>

											<div class="form-row">
												<div
													class="container border rounded-lg"
													id="tagsDataStream00"
												>
													<div class="row">
														<div class="col-md-4 mb-3 p-2">
															<label><strong>Añadir tags</strong></label>
														</div>
													</div>

													<div class="row">
														<div class="col col-6 col-md-1">
															<div class="row col-md-4 mb-3">
																<button
																	type="button"
																	id="buttonAgregarTagDataStream00"
																	onclick="agregarTagDataStream(this)"
																	class="rounded-circle btn btn-outline-success"
																>+</button>
															</div>
														</div>

														<div class="col col-12 col-md-8">
															<div class="row">
																<div class="col-md-6 mb-3">
																	<input
																		type="text"
																		class="form-control inputs"
																		id="inputTagDataStreamEspanol00"
																		placeholder="Español"
																	></input>
																</div>

																<div class="col-md-6 mb-3">
																	<input
																		type="text"
																		class="form-control inputs"
																		id="inputTagDataStreamIngles00"
																		placeholder="English"
																	></input>
																</div>
															</div>
														</div>
													</div>
														
													{% with contador1=0 %}
												
													
													{% for tag in datastreams.tags %}
													
													<div class="row" id="Tag0DataStream00">
														<div class="col col-6 col-md-1">
															<div class="row col-md-4 mb-3">
																<button onclick="eliminarTagDataStream(this)" id="buttonTag0DataStream00" type="button" class="rounded-circle btn btn-outline-danger">-</button>
															</div>
														</div>
														<div class="col col-12 col-md-8">
															<div class="row">
																<div class="col-md-6 mb-3">
																	<input type="text" class="form-control inputs" id="inputEspanolTag0DataStream00" name="inputEspanolTag0DataStream0" value="{{ tag.0}}" placeholder="Español" required="">
																</div>
																<div class="col-md-6 mb-3">
																	<input type="text" class="form-control inputs" id="inputInglesTag0DataStream00" name="inputInglesTag0DataStream0" value="{{ tag.1}}" placeholder="English" required="">
																</div>
															</div>
														</div></div>
													
													
												


													{% endfor %}
												

													<input
														id="contadorTags"
														type="hidden"
														value="{{ contador1 }}"
													></input>

													{% endwith %}
												</div>
											</div>

										    <div class="container p-3">
												<div class="row">
													<div class="col col-6">
														<button id="buttonEliminardataStream00" onclick="EliminarDataStream(this)" type="button" class="btn btn-outline-secondary">Eliminar datastream</button>
													</div>
													<button onclick="agregarDataStream()" type="button" class="btn btn-outline-secondary">Añadir otro datastream</button>
												</div></div>
										</div>
									
										{% endfor %}
                                        {% endif %}
										</div>
										<div class="container boton-footer">
												<div class="row justify-content-end">
													<button class="btn btn-danger btn-lg nextBtn" name="descargarJson" type="submit">Descargar JSON</button>
												</div>
											</div>
											<div class="container boton-footer">
												<div class="row justify-content-end">
													<button class="btn btn-danger btn-lg nextBtn" name="inicializar" type="submit">Guardar e Inicializar</button>
												</div>
											</div>

									</div>
								</div>
							</div>

						</form>
                        {% if ipDisp %}
                            <div class="container boton-footer">
                                <div class="row mr-4 justify-content-end">
                                    <button onclick="location.href='{% url 'estados' disp.getId disp.getTitle %}'" class="btn btn-primary btn-lg" >Ver sensores y actuadores</button>
                                </div>
                            </div>
                        {% endif %}
						{% else %}
						<h2>El dispositivo no existe</h2>
						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}